<form [formGroup]="form" submit="return false;">
    <div fxLayout="column" fxLayoutGap="0.5%">
        <h1>Workloads</h1>
        <mat-form-field>
            <mat-label>Implementation</mat-label>
            <mat-select formControlName="impl">
                @for (impl of Implementation | keyvalue; track impl) {
                <mat-option [value]="impl.value">{{impl.value}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
        <mat-form-field>
            <mat-label>Entity</mat-label>
            <mat-select formControlName="entity">
                <mat-option value="users">User</mat-option>
                <mat-option value="products">Product</mat-option>
                <mat-option value="orders">Order</mat-option>
                <mat-option value="custom">Custom</mat-option>
            </mat-select>
        </mat-form-field>
        <ng-container *ngIf="form.get('entity')?.value=='custom'">
            <mat-form-field>
                <mat-label>Collection</mat-label>
                <input matInput type="text" formControlName="coll">
            </mat-form-field>
            <mat-form-field>
                <mat-label>Schema</mat-label>
                <textarea matInput type="text" formControlName="schema"></textarea>
            </mat-form-field>
        </ng-container>
        <div>
            <label>Workload type</label>
            <mat-radio-group formControlName="type">
                @for (type of WorkloadType | keyvalue; track type) {
                <mat-radio-button [value]="type.value">{{type.value}}</mat-radio-button>
                }
            </mat-radio-group>
        </div>
        <div *ngIf="form.get('type')?.value==WorkloadType.READ">
            <h2>Read workload</h2>
            Find (list/find/search)

            <div *ngIf="form.get('impl')?.value==Implementation.DRIVER">
                <label>Converter</label>
                <mat-radio-group formControlName="converter">
                    @for (converter of Conventer | keyvalue; track converter) {
                    <mat-radio-button [value]="converter.value">{{converter.value}}</mat-radio-button>
                    }
                </mat-radio-group>
            </div>
            Aggregation?
        </div>
        <div *ngIf="form.get('type')?.value==WorkloadType.WRITE">
            <h2>Write workload</h2>
            <mat-form-field>
                <mat-label>Type</mat-label>
                <mat-select formControlName="opType">
                    @for (opType of OperationType | keyvalue; track opType) {
                    <mat-option [value]="opType.value">{{opType.value}}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
            <mat-form-field>
                <mat-label>No. of Workers</mat-label>
                <input matInput type="number" formControlName="numWorkers">
            </mat-form-field>
            <mat-form-field>
                <mat-label>Quantity</mat-label>
                <input matInput type="number" formControlName="qty">
            </mat-form-field>
            <mat-form-field *ngIf="form.get('impl')?.value!=Implementation.REPO">
                <mat-label>Write concern</mat-label>
                <mat-select formControlName="w">
                    @for (w of WriteConcern | keyvalue; track w) {
                    <mat-option [value]="w.value">{{w.value}}</mat-option>
                    }
                </mat-select>
            </mat-form-field>
            <div>
                <label>Type</label>
                <mat-radio-group formControlName="bulk">
                    <mat-radio-button [value]="false">{{form.get('impl')?.value==Implementation.REPO?"save":"Single operations"}}</mat-radio-button>
                    <mat-radio-button [value]="true">{{form.get('impl')?.value==Implementation.REPO?"saveAll":"Bulk operations"}}</mat-radio-button>
                </mat-radio-group>
            </div>
            Aggregation?
        </div>
        <div>
            <button type="button" mat-flat-button [disabled]="form.invalid || loading"
                (click)="save()"><mat-icon>check</mat-icon>Submit</button>
        </div>
    </div>
</form>